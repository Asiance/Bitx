<header>
  <img id="logo" src="/img/logo-header.png">
  <input id="search-input" type="text" class="dropdown-toggle" ng-model="search" autofocus>
  <div id="suggestions">
    <ul>
      <li id="{{$index}}" class='person' ng-class="{active: suggestionsPosition == $index}" ng-repeat="person in people | suggestionSearch: search" ng-click="setSearch(person.email_address)" ng-mouseover="setActive($index)" >
        <img class="username" ng-src="{{person.avatar_url}}">
        <span ng-switch on="person.id" class="username">
          <span ng-switch-when="-1">{{person.email_address}}</span>
          <span ng-switch-default>@{{person.email_address | removeDomain}}</span>
        </span><br>
        <span class="fullname">{{person.name}}</span>
      </li>
    </ul>
  </div>
  <a ng-click="openOptions()"><span class="icon-settings"></span></a>
</header>

<section>
<dl id="todos">
  <dt ng-class="overdues" id="overdues" ><a ng-click="toggleContent('overdues')">
    <span ng-switch on="(assignedTodos | keywordSearch:search | status :'1').length" class="toggle-content">
      <span ng-switch-when="0" class="icon-check"></span>
      <span ng-switch-default class="toggle"></span>
    </span>
    <h1 id="header_overdues">OVERDUES</h1>
    <span ng-show="(assignedTodos | keywordSearch:search | status :'1').length" title="{{(assignedTodos | keywordSearch:search | status :'1').length}} {{countOverdues}}" class="count-todos">{{(assignedTodos | keywordSearch:search | status :'1').length}}</span>
  </a></dt>
  <dd id="overdues_content">
  <div class="content" ng-show="filteredOverdue.length" ng-repeat="project in projects">
    <h2>{{project.name | uppercase}}</h2>
    <ul>
      <li id="{{assignedTodo.id}}" ng-repeat="assignedTodo in filteredOverdue = (project.assignedTodos | keywordSearch:search | orderBy: sortByDate | status: 1)">
        <span class="achievement"><p><img src="/img/icon-check.png">{{congratulation}}</p></span>
        <span class="date overdues" title='{{createdDate}} {{assignedTodo.created_at | elapsedTime}}'><span class ="day-number">{{assignedTodo.due_at | daysLate}}</span><br>
          <p><ng-pluralize count="assignedTodo.days_late" when='{"1": "{{dayLate}}", "other": "{{daysLate}}"}'></ng-pluralize></p>
        </span>
        <div class="todo">
          <div><span ng-click="completeTodo(project.id, assignedTodo.id)" class="checkbox"></span><span class="todo-text" title="{{assignedTodo.assignee.name | filterOn: isFiltered()}}">{{assignedTodo.content}}<span></div>
        </div>
        <span ng-click="openTodo(assignedTodo.project_id, assignedTodo.id)" class="comments" ng-show="assignedTodo.comments_count" title="{{lastUpdate}} {{assignedTodo.updated_at | elapsedTime}}">
          <p>{{assignedTodo.comments_count}}</p>
        </span>
        <span class="void" ng-hide="assignedTodo.comments_count"></span>
        <span ng-click="openTodo(assignedTodo.project_id, assignedTodo.id)" class="icon-link" title="Visit this todo"></span>
      </li>
    </ul>
  </div>
  </dd>

  <dt ng-class="today" id="today"><a ng-click="toggleContent('today')">
    <span ng-switch on="(assignedTodos | keywordSearch:search | status :'2').length" class="toggle-content">
      <span ng-switch-when="0" class="icon-check"></span>
      <span ng-switch-default class="toggle"></span>
    </span>
    <h1 id="header_today">TODAY</h1>
    <span ng-show="(assignedTodos | keywordSearch:search | status :'2').length" title="{{(assignedTodos | keywordSearch:search | status :'2').length}} {{countToday}}" class="count-todos">{{(assignedTodos | keywordSearch:search | status :'2').length}}
    </span></a></dt>
  <dd id="today_content">
  <div class="content" ng-show="filteredToday.length" ng-repeat="project in projects">
    <h2>{{project.name | uppercase}}</h2>
    <ul>
      <li id="{{assignedTodo.id}}" ng-repeat="assignedTodo in filteredToday = (project.assignedTodos | keywordSearch:search | orderBy: sortByDate | status: 2)">
        <span class="achievement"><p><img src="/img/icon-check.png">{{congratulation}}</p></span>
        <span class="date icon-today" title='{{createdDate}} {{assignedTodo.created_at | elapsedTime}}'></span>
        <div class="todo">
          <div><span ng-click="completeTodo(project.id, assignedTodo.id)" class="checkbox"></span><span class="todo-text" title="{{assignedTodo.assignee.name | filterOn: isFiltered()}}">{{assignedTodo.content}}<span></div>
        </div>
        <span ng-click="openTodo(assignedTodo.project_id, assignedTodo.id)" class="comments" ng-show="assignedTodo.comments_count" title="{{lastUpdate}} {{assignedTodo.updated_at | elapsedTime}}">
          <p>{{assignedTodo.comments_count}}</p>
        </span>
        <span class="void" ng-hide="assignedTodo.comments_count"></span>
        <span ng-click="openTodo(assignedTodo.project_id, assignedTodo.id)" class="icon-link" title="Visit this todo"></span>
    </ul>
  </div>
  </dd>

  <dt ng-class="upcoming" id="upcoming"><a ng-click="toggleContent('upcoming')">
      <span ng-switch on="(assignedTodos | keywordSearch:search | status :'3').length" class="toggle-content">
      <span ng-switch-when="0" class="icon-check"></span>
      <span ng-switch-default class="toggle"></span>
      </span>
      <h1 id="header_upcoming">UPCOMING</h1>
      <span ng-show="(assignedTodos | keywordSearch:search | status :'3').length" title="{{(assignedTodos | keywordSearch:search | status :'3').length}} {{countUpcoming}}" class="count-todos">{{(assignedTodos | keywordSearch:search | status :'3').length}}</span>
  </a></dt>
  <dd id="upcoming_content">
  <div class="content" ng-show="filteredUpcoming.length" ng-repeat="project in projects">
    <h2>{{project.name | uppercase}}</h2>
    <ul>
      <li id="{{assignedTodo.id}}" ng-repeat="assignedTodo in filteredUpcoming = (project.assignedTodos | keywordSearch:search | orderBy: sortByDate | status: 3)">
        <span class="achievement"><p><img src="/img/icon-check.png">{{congratulation}}</p></span>
        <span class="date" title='{{createdDate}} {{assignedTodo.created_at | elapsedTime}}'><span class ="day-number">{{assignedTodo.due_at | daysRemaining}}</span><br>
          <p><ng-pluralize count="assignedTodo.remaining_days" when="{'1': '{{dayLeft}}', 'other': '{{daysLeft}}'}"></ng-pluralize></p>
        </span>
        <div class="todo">
          <div><span ng-click="completeTodo(project.id, assignedTodo.id)" class="checkbox"></span><span class="todo-text" title="{{assignedTodo.assignee.name | filterOn: isFiltered()}}">{{assignedTodo.content}}<span></div>
        </div>
        <span ng-click="openTodo(assignedTodo.project_id, assignedTodo.id)" class="comments" ng-show="assignedTodo.comments_count" title="{{lastUpdate}} {{assignedTodo.updated_at | elapsedTime}}">
          <p>{{assignedTodo.comments_count}}</p>
        </span>
        <span class="void" ng-hide="assignedTodo.comments_count"></span>
        <span ng-click="openTodo(assignedTodo.project_id, assignedTodo.id)" class="icon-link" title="Visit this todo"></span>
      </li>
    </ul>
  </div>
  </dd>

  <dt ng-class="no_due_date" id="no-due-date"><a ng-click="toggleContent('no-due-date')">
    <span ng-switch on="(assignedTodos | keywordSearch:search | status :'4').length" class="toggle-content">
      <span ng-switch-when="0" class="icon-check"></span>
      <span ng-switch-default class="toggle"></span>
    </span>
    <h1 id="header_noduedate">NO DUE DATE</h1>
    <span ng-show="(assignedTodos | keywordSearch:search | status :'4').length" title="{{(assignedTodos | keywordSearch:search | status :'4').length}} {{countNoDueDate}}" class="count-todos">{{(assignedTodos | keywordSearch:search | status :'4').length}}</span>
  </a></dt>
  <dd id="no-due-date_content">
  <div class="content" ng-show="filteredUndetermined.length" ng-repeat="project in projects">
    <h2>{{project.name | uppercase}}</h2>
    <ul>
      <li id="{{assignedTodo.id}}" ng-repeat="assignedTodo in filteredUndetermined = (project.assignedTodos | keywordSearch:search | orderBy: sortByDate | status: 4)">
        <span class="achievement"><p><img src="/img/icon-check.png">{{congratulation}}</p></span>
        <span class="date icon-coffee" title='{{createdDate}} {{assignedTodo.created_at | elapsedTime}}'></span>
        <div class="todo">
          <div><span ng-click="completeTodo(project.id, assignedTodo.id)" class="checkbox"></span><span class="todo-text" title="{{assignedTodo.assignee.name | filterOn: isFiltered()}}">{{assignedTodo.content}}<span></div>
        </div>
        <span ng-click="openTodo(assignedTodo.project_id, assignedTodo.id)" class="comments" ng-show="assignedTodo.comments_count" title="{{lastUpdate}} {{assignedTodo.updated_at | elapsedTime}}">
          <p>{{assignedTodo.comments_count}}</p>
        </span>
        <span class="void" ng-hide="assignedTodo.comments_count"></span>
        <span ng-click="openTodo(assignedTodo.project_id, assignedTodo.id)" class="icon-link" title="Visit this todo"></span>
      </li>
    </ul>
  </div>
  </dd>
</dl>
</section>